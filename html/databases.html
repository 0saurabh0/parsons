

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Databases &mdash; Parsons 0.5 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="FacebookAds" href="facebook_ads.html" />
    <link rel="prev" title="CrowdTangle" href="crowdtangle.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Parsons
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Integrations</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="action_kit.html">ActionKit</a></li>
<li class="toctree-l1"><a class="reference internal" href="action_network.html">Action Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="airtable.html">Airtable</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws.html">Amazon Web Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="azure.html">Azure: Blob Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="bill_com.html">Bill.com</a></li>
<li class="toctree-l1"><a class="reference internal" href="bloomerang.html">Bloomerang</a></li>
<li class="toctree-l1"><a class="reference internal" href="braintree.html">Braintree</a></li>
<li class="toctree-l1"><a class="reference internal" href="civis.html">Civis</a></li>
<li class="toctree-l1"><a class="reference internal" href="copper.html">Copper</a></li>
<li class="toctree-l1"><a class="reference internal" href="crowdtangle.html">CrowdTangle</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Databases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#google-bigquery">Google BigQuery</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mysql">MySQL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#quick-start">Quick Start</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id4">Postgres</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id6">Quick Start</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#redshift">Redshift</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="facebook_ads.html">FacebookAds</a></li>
<li class="toctree-l1"><a class="reference internal" href="freshdesk.html">Freshdesk</a></li>
<li class="toctree-l1"><a class="reference internal" href="github.html">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="google.html">Google</a></li>
<li class="toctree-l1"><a class="reference internal" href="hustle.html">Hustle</a></li>
<li class="toctree-l1"><a class="reference internal" href="mailchimp.html">Mailchimp</a></li>
<li class="toctree-l1"><a class="reference internal" href="mobilize_america.html">Mobilize America</a></li>
<li class="toctree-l1"><a class="reference internal" href="newmode.html">New/Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="ngpvan.html">NGPVAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="pdi.html">PDI</a></li>
<li class="toctree-l1"><a class="reference internal" href="p2a.html">Phone2Action</a></li>
<li class="toctree-l1"><a class="reference internal" href="redash.html">Redash</a></li>
<li class="toctree-l1"><a class="reference internal" href="rockthevote.html">Rock the Vote</a></li>
<li class="toctree-l1"><a class="reference internal" href="salesforce.html">Salesforce</a></li>
<li class="toctree-l1"><a class="reference internal" href="sftp.html">SFTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="targetsmart.html">TargetSmart</a></li>
<li class="toctree-l1"><a class="reference internal" href="turbovote.html">TurboVote</a></li>
<li class="toctree-l1"><a class="reference internal" href="twilio.html">Twilio</a></li>
<li class="toctree-l1"><a class="reference internal" href="zoom.html">Zoom</a></li>
</ul>
<p class="caption"><span class="caption-text">Enhancements</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="census_geocoder.html">US Census Geocoder</a></li>
</ul>
<p class="caption"><span class="caption-text">Framework</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dbsync.html">Database Sync</a></li>
<li class="toctree-l1"><a class="reference internal" href="table.html">Parsons Table</a></li>
<li class="toctree-l1"><a class="reference internal" href="notifications.html">Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributor Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to Parsons</a></li>
<li class="toctree-l1"><a class="reference internal" href="build_a_connector.html">How to Build a Connector</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Parsons</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Databases</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/databases.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="databases">
<h1>Databases<a class="headerlink" href="#databases" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Parsons offers support for a variety of popular SQL database dialects. The functionality is focused on the ability to query and upload data to SQL databases. Each database class also includes the ability to infer datatypes and data schemas from a Parsons table and automatically create new tables.</p>
<p>Similar to other classes in Parsons, the query methods for databases all return <a class="reference internal" href="table.html#parsons-table"><span class="std std-ref">Parsons Table</span></a>, which allow them to be easily converted to other data types.</p>
<p>There is also support for synchronization of tables between databases as part of the <a class="reference internal" href="dbsync.html"><span class="doc">Database Sync</span></a> framework.</p>
</div>
<div class="section" id="google-bigquery">
<h2>Google BigQuery<a class="headerlink" href="#google-bigquery" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="google.html"><span class="doc">Google</span></a> for documentation.</p>
</div>
<div class="section" id="mysql">
<h2>MySQL<a class="headerlink" href="#mysql" title="Permalink to this headline">¶</a></h2>
<p>MySQL is the world’s most popular open source database. The Parsons class leverages on the <a class="reference external" href="https://github.com/farcepest/MySQLdb1">mysql</a> python package.</p>
<div class="section" id="quick-start">
<h3>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h3>
<p><strong>Authentication</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">parsons</span> <span class="kn">import</span> <span class="n">MySQL</span>

<span class="c1"># Instantiate MySQL from environmental variables</span>
<span class="n">mysql</span> <span class="o">=</span> <span class="n">MySQL</span><span class="p">()</span>

<span class="c1"># Instantiate MySQL from passed variables</span>
<span class="n">mysql</span> <span class="o">=</span> <span class="n">MySQL</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;me&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;secret&#39;</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;mydb.com&#39;</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="s1">&#39;dev&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Quick Start</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Query database</span>
<span class="n">tbl</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;select * from my_schema.secret_sauce&#39;</span><span class="p">)</span>

<span class="c1"># Copy data to database</span>
<span class="n">tbl</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;my_file.csv&#39;</span><span class="p">)</span> <span class="c1"># Load from a CSV or other source.</span>
<span class="n">mysql</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">tbl</span><span class="p">,</span> <span class="s1">&#39;my_schema.winning_formula&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="class">
<dt id="parsons.MySQL">
<em class="property">class </em><code class="descclassname">parsons.</code><code class="descname">MySQL</code><span class="sig-paren">(</span><em>host=None</em>, <em>username=None</em>, <em>password=None</em>, <em>db=None</em>, <em>port=3306</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/mysql/mysql.html#MySQL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parsons.MySQL" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to a MySQL database.</p>
<dl class="docutils">
<dt><cite>Args:</cite></dt>
<dd><dl class="first last docutils">
<dt>username: str</dt>
<dd>Required if env variable <code class="docutils literal notranslate"><span class="pre">MYSQL_USERNAME</span></code> not populated</dd>
<dt>password: str</dt>
<dd>Required if env variable <code class="docutils literal notranslate"><span class="pre">MYSQL_PASSWORD</span></code> not populated</dd>
<dt>host: str</dt>
<dd>Required if env variable <code class="docutils literal notranslate"><span class="pre">MYSQL_HOST</span></code> not populated</dd>
<dt>db: str</dt>
<dd>Required if env variable <code class="docutils literal notranslate"><span class="pre">MYSQL_DB</span></code> not populated</dd>
<dt>port: int</dt>
<dd>Can be set by env variable <code class="docutils literal notranslate"><span class="pre">MYSQL_PORT</span></code> or argument.</dd>
</dl>
</dd>
</dl>
<dl class="method">
<dt id="parsons.MySQL.connection">
<code class="descname">connection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/mysql/mysql.html#MySQL.connection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parsons.MySQL.connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a MySQL connection. The connection is set up as a python “context manager”, so
it will be closed automatically (and all queries committed) when the connection goes out
of scope.</p>
<p>When using the connection, make sure to put it in a <code class="docutils literal notranslate"><span class="pre">with</span></code> block (necessary for
any context manager):
<code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">mysql.connection()</span> <span class="pre">as</span> <span class="pre">conn:</span></code></p>
<dl class="docutils">
<dt><cite>Returns:</cite></dt>
<dd>MySQL <cite>connection</cite> object</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="parsons.MySQL.query">
<code class="descname">query</code><span class="sig-paren">(</span><em>sql</em>, <em>parameters=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/mysql/mysql.html#MySQL.query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parsons.MySQL.query" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a query against the database. Will return <a href="#id2"><span class="problematic" id="id3">``</span></a>None``if the query returns zero rows.</p>
<p>To include python variables in your query, it is recommended to pass them as parameters,
following the <a class="reference external" href="https://security.openstack.org/guidelines/dg_parameterize-database-queries.html">mysql style</a>.
Using the <code class="docutils literal notranslate"><span class="pre">parameters</span></code> argument ensures that values are escaped properly, and avoids SQL
injection attacks.</p>
<p><strong>Parameter Examples</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that the name contains a quote, which could break your query if not escaped</span>
<span class="c1"># properly.</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Beatrice O&#39;Brady&quot;</span>
<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM my_table WHERE name = </span><span class="si">%s</span><span class="s2">&quot;</span>
<span class="n">mysql</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Allen Smith&quot;</span><span class="p">,</span> <span class="s2">&quot;Beatrice O&#39;Brady&quot;</span><span class="p">,</span> <span class="s2">&quot;Cathy Thompson&quot;</span><span class="p">]</span>
<span class="n">placeholders</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">names</span><span class="p">)</span>
<span class="n">sql</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM my_table WHERE name IN (</span><span class="si">{</span><span class="n">placeholders</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="n">mysql</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt><cite>Args:</cite></dt>
<dd><dl class="first last docutils">
<dt>sql: str</dt>
<dd>A valid SQL statement</dd>
<dt>parameters: list</dt>
<dd>A list of python variables to be converted into SQL values in your query</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt>
<dd><dl class="first last docutils">
<dt>Parsons Table</dt>
<dd>See <a class="reference internal" href="table.html#parsons-table"><span class="std std-ref">Parsons Table</span></a> for output options.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="parsons.MySQL.query_with_connection">
<code class="descname">query_with_connection</code><span class="sig-paren">(</span><em>sql</em>, <em>connection</em>, <em>parameters=None</em>, <em>commit=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/mysql/mysql.html#MySQL.query_with_connection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parsons.MySQL.query_with_connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a query against the database, with an existing connection. Useful for batching
queries together. Will return <code class="docutils literal notranslate"><span class="pre">None</span></code> if the query returns zero rows.</p>
<dl class="docutils">
<dt><cite>Args:</cite></dt>
<dd><dl class="first last docutils">
<dt>sql: str</dt>
<dd>A valid SQL statement</dd>
<dt>connection: obj</dt>
<dd>A connection object obtained from <code class="docutils literal notranslate"><span class="pre">mysql.connection()</span></code></dd>
<dt>parameters: list</dt>
<dd>A list of python variables to be converted into SQL values in your query</dd>
<dt>commit: boolean</dt>
<dd>Whether to commit the transaction immediately. If <code class="docutils literal notranslate"><span class="pre">False</span></code> the transaction will
be committed when the connection goes out of scope and is closed (or you can
commit manually with <code class="docutils literal notranslate"><span class="pre">connection.commit()</span></code>).</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt>
<dd><dl class="first last docutils">
<dt>Parsons Table</dt>
<dd>See <a class="reference internal" href="table.html#parsons-table"><span class="std std-ref">Parsons Table</span></a> for output options.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="parsons.MySQL.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>tbl</em>, <em>table_name</em>, <em>if_exists='fail'</em>, <em>chunk_size=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/mysql/mysql.html#MySQL.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parsons.MySQL.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy a <a class="reference internal" href="table.html#parsons-table"><span class="std std-ref">Parsons Table</span></a> to the database.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method utilizes extended inserts rather <cite>LOAD DATA INFILE</cite> since
many MySQL Database configurations do not allow data files to be
loaded. It results in a minor performance hit compared to <cite>LOAD DATA</cite>.</p>
</div>
<dl class="docutils">
<dt>tbl: parsons.Table</dt>
<dd>A Parsons table object</dd>
<dt>table_name: str</dt>
<dd>The destination schema and table (e.g. <code class="docutils literal notranslate"><span class="pre">my_schema.my_table</span></code>)</dd>
<dt>if_exists: str</dt>
<dd>If the table already exists, either <code class="docutils literal notranslate"><span class="pre">fail</span></code>, <code class="docutils literal notranslate"><span class="pre">append</span></code>, <code class="docutils literal notranslate"><span class="pre">drop</span></code>
or <code class="docutils literal notranslate"><span class="pre">truncate</span></code> the table.</dd>
<dt>chunk_size: int</dt>
<dd>The number of rows to insert per query.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="parsons.MySQL.table_exists">
<code class="descname">table_exists</code><span class="sig-paren">(</span><em>table_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/mysql/mysql.html#MySQL.table_exists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parsons.MySQL.table_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a table or view exists in the database.</p>
<dl class="docutils">
<dt><cite>Args:</cite></dt>
<dd><dl class="first last docutils">
<dt>table_name: str</dt>
<dd>The table name</dd>
<dt>view: boolean</dt>
<dd>Check to see if a view exists by the same name</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt>
<dd><dl class="first last docutils">
<dt>boolean</dt>
<dd><code class="docutils literal notranslate"><span class="pre">True</span></code> if the table exists and <code class="docutils literal notranslate"><span class="pre">False</span></code> if it does not.</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="id4">
<h2>Postgres<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>Postgres is popular open source SQL database dialect. The Parsons class leverages the <a class="reference external" href="https://www.psycopg.org/">mysql</a> python package.</p>
<div class="section" id="id6">
<h3>Quick Start<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p><strong>Authentication</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">parsons</span> <span class="kn">import</span> <span class="n">Postgres</span>

<span class="c1"># Instantiate Postgres from environmental variables</span>
<span class="n">mysql</span> <span class="o">=</span> <span class="n">Postgres</span><span class="p">()</span>

<span class="c1"># Instantiate Postgres from passed variables</span>
<span class="n">Postgres</span> <span class="o">=</span> <span class="n">Postgres</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;me&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;secret&#39;</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;mydb.com&#39;</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="s1">&#39;dev&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">)</span>

<span class="c1"># Instantiate Postgres from a ~/.pgpass file</span>
<span class="n">Postgres</span> <span class="o">=</span> <span class="n">Postgres</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Quick Start</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Query database</span>
<span class="n">tbl</span> <span class="o">=</span> <span class="n">postgres</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;select * from my_schema.secret_sauce&#39;</span><span class="p">)</span>

<span class="c1"># Copy data to database</span>
<span class="n">tbl</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;my_file.csv&#39;</span><span class="p">)</span> <span class="c1"># Load from a CSV or other source.</span>
<span class="n">postgres</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">tbl</span><span class="p">,</span> <span class="s1">&#39;my_schema.winning_formula&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="class">
<dt id="parsons.Postgres">
<em class="property">class </em><code class="descclassname">parsons.</code><code class="descname">Postgres</code><span class="sig-paren">(</span><em>username=None</em>, <em>password=None</em>, <em>host=None</em>, <em>db=None</em>, <em>port=5432</em>, <em>timeout=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/postgres/postgres.html#Postgres"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parsons.Postgres" title="Permalink to this definition">¶</a></dt>
<dd><p>A Postgres class to connect to database. Credentials can be passed from a <code class="docutils literal notranslate"><span class="pre">.pgpass</span></code> file
stored in your home directory or with environmental variables.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>username: str</dt>
<dd>Required if env variable <code class="docutils literal notranslate"><span class="pre">PGUSER</span></code> not populated</dd>
<dt>password: str</dt>
<dd>Required if env variable <code class="docutils literal notranslate"><span class="pre">PGPASSWORD</span></code> not populated</dd>
<dt>host: str</dt>
<dd>Required if env variable <code class="docutils literal notranslate"><span class="pre">PGHOST</span></code> not populated</dd>
<dt>db: str</dt>
<dd>Required if env variable <code class="docutils literal notranslate"><span class="pre">PGDATABASE</span></code> not populated</dd>
<dt>port: int</dt>
<dd>Required if env variable <code class="docutils literal notranslate"><span class="pre">PGPORT</span></code> not populated.</dd>
<dt>timeout: int</dt>
<dd>Seconds to timeout if connection not established.</dd>
</dl>
</dd>
</dl>
<dl class="method">
<dt id="parsons.Postgres.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>tbl</em>, <em>table_name</em>, <em>if_exists='fail'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/postgres/postgres.html#Postgres.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parsons.Postgres.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy a <a class="reference internal" href="table.html#parsons-table"><span class="std std-ref">Parsons Table</span></a> to Postgres.</p>
<dl class="docutils">
<dt>tbl: parsons.Table</dt>
<dd>A Parsons table object</dd>
<dt>table_name: str</dt>
<dd>The destination schema and table (e.g. <code class="docutils literal notranslate"><span class="pre">my_schema.my_table</span></code>)</dd>
<dt>if_exists: str</dt>
<dd>If the table already exists, either <code class="docutils literal notranslate"><span class="pre">fail</span></code>, <code class="docutils literal notranslate"><span class="pre">append</span></code>, <code class="docutils literal notranslate"><span class="pre">drop</span></code>
or <code class="docutils literal notranslate"><span class="pre">truncate</span></code> the table.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="parsons.Postgres.connection">
<code class="descname">connection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#parsons.Postgres.connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a Postgres connection.
The connection is set up as a python “context manager”, so it will be closed
automatically (and all queries committed) when the connection goes out of scope.</p>
<p>When using the connection, make sure to put it in a <code class="docutils literal notranslate"><span class="pre">with</span></code> block (necessary for
any context manager):
<code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">pg.connection()</span> <span class="pre">as</span> <span class="pre">conn:</span></code></p>
<dl class="docutils">
<dt><cite>Returns:</cite></dt>
<dd>Psycopg2 <cite>connection</cite> object</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="parsons.Postgres.query">
<code class="descname">query</code><span class="sig-paren">(</span><em>sql</em>, <em>parameters=None</em><span class="sig-paren">)</span><a class="headerlink" href="#parsons.Postgres.query" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a query against the database. Will return <a href="#id7"><span class="problematic" id="id8">``</span></a>None``if the query returns zero rows.</p>
<p>To include python variables in your query, it is recommended to pass them as parameters,
following the <a class="reference external" href="http://initd.org/psycopg/docs/usage.html#passing-parameters-to-sql-queries">psycopg style</a>.
Using the <code class="docutils literal notranslate"><span class="pre">parameters</span></code> argument ensures that values are escaped properly, and avoids SQL
injection attacks.</p>
<p><strong>Parameter Examples</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that the name contains a quote, which could break your query if not escaped</span>
<span class="c1"># properly.</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Beatrice O&#39;Brady&quot;</span>
<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM my_table WHERE name = </span><span class="si">%s</span><span class="s2">&quot;</span>
<span class="n">rs</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Allen Smith&quot;</span><span class="p">,</span> <span class="s2">&quot;Beatrice O&#39;Brady&quot;</span><span class="p">,</span> <span class="s2">&quot;Cathy Thompson&quot;</span><span class="p">]</span>
<span class="n">placeholders</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">names</span><span class="p">)</span>
<span class="n">sql</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM my_table WHERE name IN (</span><span class="si">{</span><span class="n">placeholders</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="n">rs</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt><cite>Args:</cite></dt>
<dd><dl class="first last docutils">
<dt>sql: str</dt>
<dd>A valid SQL statement</dd>
<dt>parameters: list</dt>
<dd>A list of python variables to be converted into SQL values in your query</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt>
<dd><dl class="first last docutils">
<dt>Parsons Table</dt>
<dd>See <a class="reference internal" href="table.html#parsons-table"><span class="std std-ref">Parsons Table</span></a> for output options.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="parsons.Postgres.query_with_connection">
<code class="descname">query_with_connection</code><span class="sig-paren">(</span><em>sql</em>, <em>connection</em>, <em>parameters=None</em>, <em>commit=True</em><span class="sig-paren">)</span><a class="headerlink" href="#parsons.Postgres.query_with_connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a query against the database, with an existing connection. Useful for batching
queries together. Will return <code class="docutils literal notranslate"><span class="pre">None</span></code> if the query returns zero rows.</p>
<dl class="docutils">
<dt><cite>Args:</cite></dt>
<dd><dl class="first last docutils">
<dt>sql: str</dt>
<dd>A valid SQL statement</dd>
<dt>connection: obj</dt>
<dd>A connection object obtained from <code class="docutils literal notranslate"><span class="pre">redshift.connection()</span></code></dd>
<dt>parameters: list</dt>
<dd>A list of python variables to be converted into SQL values in your query</dd>
<dt>commit: boolean</dt>
<dd>Whether to commit the transaction immediately. If <code class="docutils literal notranslate"><span class="pre">False</span></code> the transaction will
be committed when the connection goes out of scope and is closed (or you can
commit manually with <code class="docutils literal notranslate"><span class="pre">connection.commit()</span></code>).</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt>
<dd><dl class="first last docutils">
<dt>Parsons Table</dt>
<dd>See <a class="reference internal" href="table.html#parsons-table"><span class="std std-ref">Parsons Table</span></a> for output options.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="parsons.Postgres.table_exists">
<code class="descname">table_exists</code><span class="sig-paren">(</span><em>table_name</em>, <em>view=True</em><span class="sig-paren">)</span><a class="headerlink" href="#parsons.Postgres.table_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a table or view exists in the database.</p>
<dl class="docutils">
<dt><cite>Args:</cite></dt>
<dd><dl class="first last docutils">
<dt>table_name: str</dt>
<dd>The table name and schema (e.g. <code class="docutils literal notranslate"><span class="pre">myschema.mytable</span></code>).</dd>
<dt>view: boolean</dt>
<dd>Check to see if a view exists by the same name</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt>
<dd><dl class="first last docutils">
<dt>boolean</dt>
<dd><code class="docutils literal notranslate"><span class="pre">True</span></code> if the table exists and <code class="docutils literal notranslate"><span class="pre">False</span></code> if it does not.</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="redshift">
<h2>Redshift<a class="headerlink" href="#redshift" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="aws.html"><span class="doc">Amazon Web Services</span></a> section for documentation.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="facebook_ads.html" class="btn btn-neutral float-right" title="FacebookAds" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="crowdtangle.html" class="btn btn-neutral" title="CrowdTangle" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, The Movement Cooperative

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>